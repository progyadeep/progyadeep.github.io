<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Ham Radio Basic QUIZ | FlyByProggy</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

        <meta name="description" content="Exam preparation package for the Canadian Amateur Radio Basic Exam"/>
        <meta name="keywords" content="amateur radio, ham radio, amateur radio canada, ham operators of canada, radio amateurs of canada, ISED Canada, radio, radio licence, ITU"/>

        <link rel="stylesheet" href="../res/css.homepage.css"/>
        <link rel="stylesheet" href="../res/css.common.css"/>

        <style>
            button{
                font-family:'Open Sans';
            }

            button.quiz-op{
                cursor:pointer;
                padding:5px 10px 5px 10px;
                text-align:left;
                border:0;
                transition:0.2s;
            }

            button.quiz-op:hover{
                background-color: #bcb;
            }
        </style>
    </head>
    <body>
        <div class="body-container">
            <h1 align="center"><img src="../res/flybyproggylogo3_5x2.svg" height="150px" width="265px"/></h1>
            <hr/>
            <br/>

            <h1>CANADIAN HAM RADIO BASIC QUIZ</h1>
            <p align="justify">Select a question bank and click "Go!" to start the quiz. Selecting the right answer will award you 1 point and turn the option <strong>green</strong>. Selecting the wrong 
            answer will turn the option <strong>red</strong> and you can keep clicking the other options until you find the right answer.</p>
            
            <p align="justify">To restart the quiz or start another bank, simply select the same or another bank from the dropdown and hit "Go!" again.</p>

            <br/>
            Select Question Bank: <select id="bank_sel" onchange="javascript:set_qb_subset()">
            	<option></option>
            	<option value="basic">Basic</option>
            	<option value="adv">Advanced</option>
            </select><br/><br/>
            Select subset: <select id="qb_subset"></select> 
            <button onclick="javascript:jsdo()">Go!</button>
            <!--input type="file" onchange="javascript:jsdo(event)"/-->
    
            <br/><br/>
            <div id="cd">
                <h4>Score: <span id="sc"></span></h4>
                <br/><br/>
                <div id="q"></div>
                <br/><br/><br/><br/>
                <button onclick="javascript:showQ()">Next</button>
            </div>

            <br/><br/>
            <hr/>
            <p id="footer"></p>
            <br/><br/>
        </div>

        <script>
            var sc = 0;
            var att = 0;
            var this_att = false;
            var this_answer = "";
            var q_div = document.getElementById('q');
            var sc_sp = document.getElementById('sc');
            var qs;
            var ql;
            var qb = document.getElementById('bank_sel');
            var qs = document.getElementById('qb_subset');
            
            function set_qb_subset(){
            	var ch = qb.value;
            	var qb_t = "<option value=\"1\">1</option>"
                +"<option value=\"2\">2</option>"
                +"<option value=\"3\">3</option>"
                +"<option value=\"4\">4</option>"
                +"<option value=\"5\">5</option>"
                +"<option value=\"6\">6</option>"
                +"<option value=\"7\">7</option>"
                +"<option value=\"8\">8</option>"
                +"<option value=\"9\">9 </option>"
                +"<option value=\"10\">10</option>"
                +"<option value=\"11\">11</option>";
                
                if(ch=='basic'){
                	qb_t += "<option value=\"12\">12</option>"
                	+"<option value=\"13\">13</option>"
                	+"<option value=\"14\">14</option>"
                	+"<option value=\"15\">15</option>"
                	+"<option value=\"16\">16</option>"
                	+"<option value=\"17\">17 </option>"
                	+"<option value=\"18\">18</option>"
                	+"<option value=\"19\">19</option>"
                	+"<option value=\"20\">20</option>";
                }
                qb_t += "<option value=\"all\">ALL</option>";
                
                qs.innerHTML = qb_t;
            }

            function jsdo(/*event*/){
                /*var reader = new FileReader();
                reader.onload = function(){
                    var text = reader.result;
                    
                    qs = text.split("\n");
                    ql = qs.length;

                    this_att = true;
                    showQ();
                };
                reader.readAsText(event.target.files[0]);*/
				alert("quiz_banks/"+qb.value.toString()+"_"+qs.value.toString()+".txt");
				return;
                fetch("quiz_banks/"+qb.value.toString()+"_"+qs.value.toString()+".txt")
                .then( r => r.text() )
                .then( function(text){
                    qs = text.split("\n");
                    ql = qs.length;

                    this_att = true;
                    showQ();
                });

                //----re-init global variables----
                sc=0;
                att=0;
                this_att=false;
                this_answer="";
                qs=null;
                ql=null;
            }

            function showQ(){
                if(this_att){
                    this_att = false;
                    if(ql > 0){
                        sc_sp.innerHTML = sc + "/" + att;
                        var qn = Math.floor(Math.random() * ql);
                        var qd = qs[qn].split(";");
                        var qdt = qd[1] + "<br/>";
                        this_answer = qd[2];
                        var c = 4;
                        while(c>0){
                            var ti = (Math.floor(Math.random() * c) + 2);
                            qdt = qdt + "<br/><br/> <button class=\"quiz-op\" onclick=\"javascript:checkAns(this)\">" + qd[ti] + "</button>";
                            qd.splice(ti, 1);
                            c = c - 1;
                        }
                        q_div.innerHTML = qdt;

                        qs.splice(qn,1);
                        ql = ql-1;
                    }
                    else{
                        q_div.innerHTML = "<h3>END OF QUIZ</h3>";
                    }
                }
            }

            function checkAns(obj){
                if(!this_att)
                    att++;

                obj.style.backgroundColor = "green";
                obj.style.color = "white";
                if(obj.innerHTML != this_answer){
                    obj.style.backgroundColor = "red";
                }
                else if(!this_att){
                    sc = sc + 1;
                }
                sc_sp.innerHTML = sc + "/" + att;
                this_att = true;
            }
        </script>

        <script src="../../res/script.common.js"></script>
    </body>
</html>
